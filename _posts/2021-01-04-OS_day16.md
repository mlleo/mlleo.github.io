---
title: "[OS] Memory Management 2"
categories: 
  - CS
tags:
  - Operating System
last_modified_at: 2021-01-04 12:00:00
comments: true
use_math: true # MathJax On
---

Memory Management Part 2

#### Paging 
- Permit the physical address space of a process to be non-contiguous
- Divide physical memory into fixed-sized blocks called ***page frames*** or ***frames***
- Divide logical address space into the same sized blocks called ***pages***
  - Usually, pages(or frames) size is a power of 2 (typically 512B ~ 8KB)
  - Some systems allow huge pages
- To run a program of size n, find n free frames and load the program
- Set up a page table to translate logical to physical addresses
- OS keeps track of all free frames

![page](https://user-images.githubusercontent.com/62474292/112705133-c262b780-8ee0-11eb-959c-79f80743d727.JPG)

- Still, some internal fragmentation exists
  - page size = 4KB
  - process size = 72,766 bytes
  - 72,766 bytes / 4KB = 17 pages + 3,134 bytes
  - Internal fragmentation : 4,096(page size) - 3,134 = 962
- If small frame sizes
  - need more mapping entries in the page table

#### Page Tables
- Each process has its own page table (page table : process level)
  - Page-table base register (PTBR) points to the base address of the page table
- Managed by OS, accessed by MMU
- One page table entry (PTE) per page in virtual address space
- Map Virtual Page Number (VPN) to Page Frame Number (PFN)
  - VPN : An index into the page table
  - Virtual address = <Virtual Page Number(VPN), Offset>
  - Physical address = <Page Frame Number(PFN), Offset>

![pageframe](https://user-images.githubusercontent.com/62474292/112714917-1b057500-8f20-11eb-9fc9-6c4ae3e67c44.JPG)


#### Address Translation
- Address generated by CPU is divided into Page number(p) and Page offset(d)
- Page number : used as an index into a page table which contains base address of each page in physical memory
- Page offset : combined with base address to define the physical memory address that is sent to the memory unit 

![page address](https://user-images.githubusercontent.com/62474292/112714963-7fc0cf80-8f20-11eb-9f2c-eaa6e0a362d0.JPG)

